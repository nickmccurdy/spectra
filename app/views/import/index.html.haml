.header
  %h1 Let's import some data!
.content
  %form.pure-form.pure-form-aligned
    .fieldset
      .pure-control-group
        = label_tag(:q, "Import path:")
        = text_field_tag(:q)
      .pure-controls
        = submit_tag("Import", class: "pure-button pure-button-primary")

:javascript
  $("a[href='/import']").parent().addClass("menu-item-divided pure-menu-selected");
  $('form').submit(function(event) {
    var valuesToSubmit = $(this).serialize();
    var source = new EventSource('/import/add?'+ valuesToSubmit);


    source.addEventListener('message', function (e) {
      console.log('Received a message:', e.data);
    });

    source.addEventListener('close', function () {
      source.close();
    })

    event.preventDefault();
  });